
# Cheking if a 4x4 Mueller matrix is positive-efinite using Sylvester's criterion

# The coefficients of the principal leading minors are written explicitly and were
# pre-computed and simplified in Maple. In these formulas, the function H is applied first
# and then the positive-definiteness of H(M) is assessed.

function D1(M)
  return M[1, 1] + M[1, 2] + M[2, 1] + M[2, 2]
end

function D2(M)
  return M[1,1]^2+2*M[1,1]*M[2,1]-M[1,2]^2-2*M[1,2]*M[2,2]-M[1,3]^2-2*M[1,3]*M[2,3]-M[1,4]^2-2*M[1,4]*M[2,4]+M[2,1]^2-M[2,2]^2-M[2,3]^2-M[2,4]^2
end

function D3(M)
  return M[1,1]^3+(M[1,2]+M[2,1]-M[2,2])*M[1,1]^2+(-M[1,2]^2+(2*M[2,1]-2*M[2,2])*M[1,2]-M[3,2]^2-2*M[3,1]*M[3,2]-M[3,3]^2+2*M[3,3]*M[4,4]-M[3,4]^2-2*M[3,4]*M[4,3]-M[4,1]^2-2*M[4,1]*M[4,2]-M[4,2]^2-M[4,3]^2-M[4,4]^2-M[1,3]^2-2*M[1,3]*M[2,3]-M[1,4]^2-2*M[1,4]*M[2,4]-M[2,1]^2-2*M[2,1]*M[2,2]-M[2,2]^2-M[2,3]^2-M[2,4]^2-M[3,1]^2)*M[1,1]-M[1,2]^3+(M[2,1]-M[2,2])*M[1,2]^2+(-M[1,3]^2-2*M[1,3]*M[2,3]-M[1,4]^2-2*M[1,4]*M[2,4]+M[2,1]^2+2*M[2,1]*M[2,2]+M[2,2]^2-M[2,3]^2-M[2,4]^2+M[3,1]^2+2*M[3,1]*M[3,2]+M[3,2]^2-M[3,3]^2+2*M[3,3]*M[4,4]-M[3,4]^2-2*M[3,4]*M[4,3]+M[4,1]^2+2*M[4,1]*M[4,2]+M[4,2]^2-M[4,3]^2-M[4,4]^2)*M[1,2]-M[2,1]^3-M[2,1]^2*M[2,2]+(M[1,3]^2+2*M[1,3]*M[2,3]+M[1,4]^2+2*M[1,4]*M[2,4]+M[2,2]^2+M[2,3]^2+M[2,4]^2-M[3,1]^2-2*M[3,1]*M[3,2]-M[3,2]^2-M[3,3]^2+2*M[3,3]*M[4,4]-M[3,4]^2-2*M[3,4]*M[4,3]-M[4,1]^2-2*M[4,1]*M[4,2]-M[4,2]^2-M[4,3]^2-M[4,4]^2)*M[2,1]+M[2,2]^3+(M[1,3]^2+2*M[1,3]*M[2,3]+M[1,4]^2+2*M[1,4]*M[2,4]+M[2,3]^2+M[2,4]^2+M[3,1]^2+2*M[3,1]*M[3,2]+M[3,2]^2-M[3,3]^2+2*M[3,3]*M[4,4]-M[3,4]^2-2*M[3,4]*M[4,3]+M[4,1]^2+2*M[4,1]*M[4,2]+M[4,2]^2-M[4,3]^2-M[4,4]^2)*M[2,2]+((2*M[3,3]-2*M[4,4])*M[3,1]+(2*M[3,3]-2*M[4,4])*M[3,2]+2*(M[4,1]+M[4,2])*(M[3,4]+M[4,3]))*M[1,3]+((2*M[3,4]+2*M[4,3])*M[3,1]+(2*M[3,4]+2*M[4,3])*M[3,2]-2*(M[4,1]+M[4,2])*(M[3,3]-M[4,4]))*M[1,4]+((2*M[3,3]-2*M[4,4])*M[3,1]+(2*M[3,3]-2*M[4,4])*M[3,2]+2*(M[4,1]+M[4,2])*(M[3,4]+M[4,3]))*M[2,3]+2*M[2,4]*((M[3,4]+M[4,3])*M[3,1]+(M[3,4]+M[4,3])*M[3,2]-(M[4,1]+M[4,2])*(M[3,3]-M[4,4]))
end

function D4(M)
  return M[1,1]^4+M[1,2]^4+M[1,3]^4+M[2,1]^4+M[2,2]^4+M[2,3]^4+M[3,1]^4+M[3,2]^4+M[3,3]^4+M[1,4]^4+M[2,4]^4+M[3,4]^4+8*M[3,3]*M[3,4]*M[4,3]*M[4,4]-8*M[4,1]*(M[3,2]*M[4,2]+M[3,3]*M[4,3]+M[3,4]*M[4,4])*M[3,1]+8*M[4,2]*(M[3,3]*M[4,3]+M[3,4]*M[4,4])*M[3,2]+8*M[2,4]*(M[3,3]*M[3,4]+M[4,3]*M[4,4])*M[2,3]+(M[4,1]^2-M[4,2]^2-M[4,3]^2-M[4,4]^2)^2+(2*M[4,1]^2-2*M[4,2]^2-2*M[4,3]^2+2*M[4,4]^2)*M[3,4]^2+(2*M[3,4]^2+2*M[4,1]^2-2*M[4,2]^2+2*M[4,3]^2-2*M[4,4]^2)*M[3,3]^2+(2*M[3,3]^2+2*M[3,4]^2+2*M[4,1]^2+2*M[4,2]^2-2*M[4,3]^2-2*M[4,4]^2)*M[3,2]^2+(-2*M[3,2]^2-2*M[3,3]^2-2*M[3,4]^2+2*M[4,1]^2+2*M[4,2]^2+2*M[4,3]^2+2*M[4,4]^2)*M[3,1]^2+(2*M[3,1]^2-2*M[3,2]^2-2*M[3,3]^2+2*M[3,4]^2+2*M[4,1]^2-2*M[4,2]^2-2*M[4,3]^2+2*M[4,4]^2)*M[2,4]^2+(2*M[2,4]^2+2*M[3,1]^2-2*M[3,2]^2+2*M[3,3]^2-2*M[3,4]^2+2*M[4,1]^2-2*M[4,2]^2+2*M[4,3]^2-2*M[4,4]^2)*M[2,3]^2+((8*M[3,2]*M[3,3]+8*M[4,2]*M[4,3])*M[2,3]+8*M[2,4]*(M[3,2]*M[3,4]+M[4,2]*M[4,4]))*M[2,2]+(2*M[2,3]^2+2*M[2,4]^2+2*M[3,1]^2+2*M[3,2]^2-2*M[3,3]^2-2*M[3,4]^2+2*M[4,1]^2+2*M[4,2]^2-2*M[4,3]^2-2*M[4,4]^2)*M[2,2]^2+((-8*M[3,1]*M[3,2]-8*M[4,1]*M[4,2])*M[2,2]+(-8*M[3,1]*M[3,3]-8*M[4,1]*M[4,3])*M[2,3]-8*M[2,4]*(M[3,1]*M[3,4]+M[4,1]*M[4,4]))*M[2,1]+(-2*M[2,2]^2-2*M[2,3]^2-2*M[2,4]^2+2*M[3,1]^2+2*M[3,2]^2+2*M[3,3]^2+2*M[3,4]^2+2*M[4,1]^2+2*M[4,2]^2+2*M[4,3]^2+2*M[4,4]^2)*M[2,1]^2+((-8*M[3,2]*M[4,3]+8*M[3,3]*M[4,2])*M[2,1]+(8*M[3,1]*M[4,3]-8*M[3,3]*M[4,1])*M[2,2]+8*M[2,3]*(-M[3,1]*M[4,2]+M[3,2]*M[4,1]))*M[1,4]+(-2*M[2,1]^2+2*M[2,2]^2+2*M[2,3]^2-2*M[2,4]^2-2*M[3,1]^2+2*M[3,2]^2+2*M[3,3]^2-2*M[3,4]^2-2*M[4,1]^2+2*M[4,2]^2+2*M[4,3]^2-2*M[4,4]^2)*M[1,4]^2+((-8*M[2,3]*M[2,4]-8*M[3,3]*M[3,4]-8*M[4,3]*M[4,4])*M[1,4]+(8*M[3,2]*M[4,4]-8*M[3,4]*M[4,2])*M[2,1]+(-8*M[3,1]*M[4,4]+8*M[3,4]*M[4,1])*M[2,2]-8*M[2,4]*(-M[3,1]*M[4,2]+M[3,2]*M[4,1]))*M[1,3]+(2*M[1,4]^2-2*M[2,1]^2+2*M[2,2]^2-2*M[2,3]^2+2*M[2,4]^2-2*M[3,1]^2+2*M[3,2]^2-2*M[3,3]^2+2*M[3,4]^2-2*M[4,1]^2+2*M[4,2]^2-2*M[4,3]^2+2*M[4,4]^2)*M[1,3]^2+((-8*M[2,2]*M[2,3]-8*M[3,2]*M[3,3]-8*M[4,2]*M[4,3])*M[1,3]+(-8*M[2,2]*M[2,4]-8*M[3,2]*M[3,4]-8*M[4,2]*M[4,4])*M[1,4]+(-8*M[3,3]*M[4,4]+8*M[3,4]*M[4,3])*M[2,1]+(8*M[3,1]*M[4,4]-8*M[3,4]*M[4,1])*M[2,3]+8*M[2,4]*(-M[3,1]*M[4,3]+M[3,3]*M[4,1]))*M[1,2]+(2*M[1,3]^2+2*M[1,4]^2-2*M[2,1]^2-2*M[2,2]^2+2*M[2,3]^2+2*M[2,4]^2-2*M[3,1]^2-2*M[3,2]^2+2*M[3,3]^2+2*M[3,4]^2-2*M[4,1]^2-2*M[4,2]^2+2*M[4,3]^2+2*M[4,4]^2)*M[1,2]^2+((8*M[2,1]*M[2,2]+8*M[3,1]*M[3,2]+8*M[4,1]*M[4,2])*M[1,2]+(8*M[2,1]*M[2,3]+8*M[3,1]*M[3,3]+8*M[4,1]*M[4,3])*M[1,3]+(8*M[2,1]*M[2,4]+8*M[3,1]*M[3,4]+8*M[4,1]*M[4,4])*M[1,4]+(8*M[3,3]*M[4,4]-8*M[3,4]*M[4,3])*M[2,2]+(-8*M[3,2]*M[4,4]+8*M[3,4]*M[4,2])*M[2,3]+8*M[2,4]*(M[3,2]*M[4,3]-M[3,3]*M[4,2]))*M[1,1]+(-2*M[1,2]^2-2*M[1,3]^2-2*M[1,4]^2-2*M[2,1]^2-2*M[2,2]^2-2*M[2,3]^2-2*M[2,4]^2-2*M[3,1]^2-2*M[3,2]^2-2*M[3,3]^2-2*M[3,4]^2-2*M[4,1]^2-2*M[4,2]^2-2*M[4,3]^2-2*M[4,4]^2)*M[1,1]^2
end

function SC(M)
  return ((D1(M) > 0) & (D2(M) > 0) & (D3(M) > 0) & (D4(M) > 0))
end
